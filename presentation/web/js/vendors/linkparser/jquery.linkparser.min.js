/*LinkParser Plugin v.0.3 (https://github.com/maparrar/linkparser)
 *Apr 2013
 * - Tony of Redsunsoft: http://www.redsunsoft.com/2011/01/parse-link-like-facebook-with-jquery-and-php/
 * - maparrar: maparrar (at) gmail (dot) com
 **/
;(function(e){function t(t,i,s){var o={urlDefault:"",withInput:true};var u=e.extend(o,i);t.addClass("linkparser");t.append(r(u));if(!u.withInput){n(t,u,s)}t.find(".lp_parse").click(function(e){e.preventDefault();n(t,u,s)})}function n(t,n,r){var s=t.find(".lp_url").val();if(!n.withInput){s=n.urlDefault}var o=t.find(".lp_loading");var u=t.find(".lp_url");var a=t.find(".lp_content");var f=t.find(".lp_info");var l=t.find(".lp_response_title");var c=t.find(".lp_response_description");var h=t.find(".lp_total_images_info");var p=t.find(".lp_response_total_images");var d=t.find(".lp_response_images");var v=t.find(".lp_cur_image");var m=t.find(".lp_cur_image_num");var g=t.find(".lp_prev");var y=t.find(".lp_next");if(!i(s)){system.message("Please enter a valid url.");return false}else{o.show();u.html(s);e.post(n.fetchScript,{url:escape(s)},function(t){l.text(t.title);c.text(t.description);p.text(t.total_images);if(t.total_images>0){d.empty();e.each(t.images,function(e,t){d.append('<img src="'+t.img+'" width="100" id="'+(e+1)+'">')});d.find("img").hide();d.find("img#1").fadeIn();v.val(1);m.html(1)}else{d.hide();f.width("100%");h.text("No images available")}a.fadeIn("slow");o.hide();if(r){r()}g.click(function(e){e.preventDefault();var t=parseInt(p.text());if(t>0){var n=v.val();var r=0;d.find("img#"+n).hide();if(n>1){r=parseInt(n)-parseInt(1)}else{r=t}v.val(r);m.text(r);d.find("img#"+r).show()}});y.click(function(e){e.preventDefault();var t=parseInt(p.text());if(t>0){var n=v.val();var r=0;d.find("img#"+n).hide();if(n<t){r=parseInt(n)+parseInt(1)}else{r=1}v.val(r);m.text(r);d.find("img#"+r).show()}})})}}function r(e){var t="";if(e.withInput){t='<input class="lp_url" type="text" value="'+e.urlDefault+'">'+'<input class="lp_parse" type="button" value="Parse" />'}return'<div class="lp_link">'+t+'<input type="hidden" class="lp_cur_image" />'+"</div>"+'<div class="lp_loader">'+'<div class="lp_loading" align="center" id="atc_loading"></div>'+'<div class="lp_content">'+'<div class="lp_response_images"></div>'+'<div class="lp_info">'+'<div class="lp_response_title"></div>'+'<div class="lp_url"></div>'+'<div class="lp_response_description"></div>'+"</div>"+'<div class="lp_total_image_nav" >'+'<a class="lp_prev" href="#" id="prev"></a>'+'<a class="lp_next" href="#" id="next"></a>'+"</div>"+'<div class="lp_total_images_info" >'+'Showing <span class="lp_cur_image_num">0</span> of <span class="lp_response_total_images">0</span> images'+"</div>"+"</div>"+"</div>"}function i(e){var t=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;if(t.test(e)){return true}else{return false}}e.fn.linkparser=function(n,r){switch(n){case"hideCutted":hideCutted(this);break;default:return this.each(function(){t(e(this),n,r)})}};})(jQuery);